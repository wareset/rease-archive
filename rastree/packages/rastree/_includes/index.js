/* eslint-disable */
const e=require("jsx2tokens"),n=require("../utilites/index.js"),r=require("../storefy/index.js");var t=JSON.stringify,s="Brace",i="AtRuleLine",a="AtRuleBlock",l="Selector",u="Keyframe",o="Attribute";function c(e){return t(e).slice(1,-1)}function f(e){for(var n,r=e.length;r-- >0&&void 0===(n=e[r]););return n}function h(e){return e.replace(/\s$/,"")}function p(e){for(var n,r,t=[],s="",i=-1;++i<e.length;)(r=e[i])&&("@"!==r[0]?s=r:(/^@media\b/.test(r)&&(null!=n&&t.splice(n,1),n=t.length),t.push(r)));return s&&t.push(s),t}function g(e,n,r){e.push([n,r])}exports.styles=function(v,d,E,k){if("`"!==(v=v.trim())[0])throw v;for(var b={},R=e.jsx2tokens(v,{useJSX:!1,proxy:function(n){n.type===e.TOKEN_TYPES.IDENTIFIER&&(b[n.value]=!0)}}),S=0,j="_s";j+S in b;)S++;j+=S;for(var y="_p";y+S in b;)S++;y+=S;var m=0,w=R[0].deep,x={},A=null;v="";for(var O,T=R.length;T-- >0;)(O=R[T]).deep===w?(A=null,v=(O.value=n.safeRemoveQuotes(O.value))+v):null==A?(O.type=e.TOKEN_TYPES.MODIFIER,x[A="%REASE%PROP%"+m+++"%"]=O.value,v=(O.value=A)+v):(R.splice(T,1),x[A]=O.value+x[A]);var P=[],I=[],_=[],N=[],$={},q=[];!function(e,n){var r,t,c,f,p=[],g=e.length,v=!0,d=v,E=0,k="",b=0,R=[],S=-1,j=!1;function y(e){var r;((k=h(k))&&R.push(k)||R.length)&&("@"===R[0][0]?(k=R.shift(),(c=k.match(/@[\w-]+/)[0].length)<k.length-1&&R.unshift(k.slice(" "===k[c]?c+1:c)),R.unshift(k.slice(0,c)),e=e===l?(!j&&"@keyframes"===R[0]&&(j=!0,S=b),a):i):j&&(e===s&&"}"===R[0]&&b<=S?j=!1:e===l&&(e=u)),e===o&&(r=R).unshift.apply(r,R.shift().split(/(:)/)),p.push({deep:b,type:e,data:R}),k="",R=[],n&&n(p[p.length-1],p.length,p))}for(var m=-1;++m<g;)if((d=v)!==(v=!(r=e[m]).trim()&&(r=" ",!0))||!v)switch(r){case"{":k=h(k),v=!0,E?k+=r:(y(l),k=r,y(s),b++);break;case"}":k=h(k),v=!0,E?k+=r:(y(o),b>0&&b--,k=r,y(s));break;case";":k=h(k),v=!0,E?k+=r:y(o);break;case"(":E++;case"[":v=!0,E<2&&(k&&R.push(k),k=""),k+=r;break;case")":E--;case"]":k=h(k)+r,E||(R.push(k),k="");break;case",":v=!0,k=h(k),E?k+=r:(k&&R.push(k),R.push(r),k="");break;case":":case"=":v=!0,k=h(k)+r;break;case"`":case"'":case'"':for(k+=r,f=!1;++m<g&&(k+=e[m],f||e[m]!==r);f=!f&&"\\"===e[m]);break;case"/":if("*"===(t=e[m+1])){for(t=k,k=r,v=d;++m<g&&!((k+=e[m]).length>3&&"/"===e[m]&&"*"===e[m-1]););k=t}else if("/"===t){for(t=k,k=r,v=d;++m<g&&(k+=e[m],/[^\r\n\u2028\u2029]/.test(e[m])););k=t}else r&&(k+=r);break;default:k+=r}y(o)}(v,(function(e){var n=e.deep,r=e.type,t=e.data;switch(r){case s:"}"===t[0]&&(P.length=I.length=_.length=n,P[n]=I[n]=_[n]=void 0);break;case l:P[n]=void 0,P[n]=function(e,n){for(var r,t,s=[],i=[],a=!1,l=e.length,u=-1;u++<l;)if(u===l||","===(t=e[u])){a||(i[0]&&!/^[|>+~\s]/.test(i[0])&&i.unshift(" "),i.unshift("&"));for(var o=-1;++o<n.length;)r=i.map((function(e){return"&"===e?this[0]:e}),[n[o]]).join("").replace(/^[\s,&|>+~]+|[\s,&|>+~]+$/g,""),r&&s.push(r);a=!1,i=[]}else if("("===t[0]||"["===t[0])i.push(t);else for(var c=t.split(/(&)|\s*([|>+~\s])\s*/),f=-1;++f<c.length;)c[f]&&("&"===(t=c[f])?a=!0:t=t.replace(/\.?\$(\w+)/g,"%REASE%SELECTOR%$1"),i.push(t));return s}(t,f(P)||[""]),_[n]=f(P).join(",");break;case u:_[n]=t.join("");break;case a:if("@media"===t[0])I[n]=void 0,I[n]=function(e,n){for(var r,t,s=[],i=[],a=e.length,l=-1;l++<a;)if(l===a||","===(t=e[l])){if(r=i.join(""))for(var u=-1;++u<n.length;)s.push(n[u]?n[u]+" and "+r:r);i=[]}else i.push(t);return s}(t.slice(1),f(I)||[""]),_[n]=t[0]+" "+f(I).join(",");else _[n]=t[0]+(t.length>1?" "+t.slice(1).join(""):"");break;case i:g(N,p(_),c(t[0]+(t.length>1?" "+t.slice(1).join(""):"")));break;case o:g(N,p(_),c(t.join("")).replace(/^\s*(\w[\w-]*)\s*:/,(function(e,n){return n in $||($[n]=q.length,q.push(n)),'"+'+y+"["+$[n]+']+"'})))}}));var C,F='"'+function(e){for(var n,r,t="",s=[],i=0,a=-1;a++<e.length;){var l=e[a]||[[],""];for(n=l[0],r=l[1],i=s.length;i>0&&""+s.slice(0,i)!=""+n.slice(0,i);)";"===t[t.length-1]&&(t=t.slice(0,-1)),t+="}",i--;for(;i<n.length;i++)t+=c(n[i])+"{";r&&(t+=r+";"),s=n}return t}(N)+'"',K={},L=[];for(var B in d=function(e){for(var n=function(e){for(var n,r=1,t=(e+="").length,s=t/99|0||1,i=0;i<t;i+=s)13===(n=e.charCodeAt(i))?i-=s-1:(r+=n*r*997/(n+r)+.0001002707309736288)>0&&(r-=0|r);return r}(e).toString(36).slice(2)||"0";n.length<9;)n+=n;return n=n.slice(0,9),/\d/.test(n[0])&&(n="h"+n.slice(0,8)),n}(d+v),F=F.replace(/%REASE%SELECTOR%(\w+)/g,(function(e,n){return n in K||(K[n]=L.length,L.push(n)),'."+'+j+"+"+K[n]+'+"'})),x)r.isStorefyForExpo(C=k(x[B]))||(x[B]="("+C+")!!");return F=function(e,n){return e.replace(/(%REASE%PROP%\d+%)/g,(function(e,r){return r in n?'"+('+n[r]+')+"':r})).trim()}(F,x),F=k(F=F.replace(/""\s*\+\s*/g,"")),'{\n  id: "'+d+'",\n  _: ('+y+(L.length?", "+j:"")+") => ("+F+"),\n  on() {\n    "+E+"(\n      this,\n      "+t(L)+",\n      "+t(q)+"\n    )\n  }\n}"},exports.v=t;
